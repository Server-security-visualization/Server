package com.dca.spring.src.malware;

import com.dca.spring.config.BaseException;
import com.dca.spring.config.BaseResponse;
import com.dca.spring.config.BaseResponseStatus;
import com.dca.spring.src.malware.model.*;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/malware")
public class MalController {
    private final MalProvider malProvider;
    private final MalService malService;

    @Autowired
    public MalController(MalProvider malProvider, MalService malService) {
        this.malProvider = malProvider;
        this.malService = malService;
    }

    /** Malware List 조회
     * [GET]
     * /malware/list
     **/
    @GetMapping("/list")
    public BaseResponse<MalListRes> MalList(){
        try{
            MalListRes malListRes = malProvider.MalListPro();
            return new BaseResponse<>(malListRes);

        } catch(BaseException exception){
            return new BaseResponse<>((exception.getStatus()));
        }
    }
}